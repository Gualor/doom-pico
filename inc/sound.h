/* Header guard ------------------------------------------------------------- */

#ifndef SOUND_H
#define SOUND_H

/* Includes ----------------------------------------------------------------- */

#include <stdbool.h>
#include <stdint.h>

#include "constants.h"

/* Definitions -------------------------------------------------------------- */

static const uint8_t MUS_S1_SND_LEN = 38;
static const uint8_t mus_s1_snd[] = {
    0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99, 0x99,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P1_SND_LEN = 19;
static const uint8_t mus_p1_snd[] = {0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                                     0x20, 0x20, 0x20, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P2_SND_LEN = 19;
static const uint8_t mus_p2_snd[] = {0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33,
                                     0x33, 0x33, 0x33, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P3_SND_LEN = 19;
static const uint8_t mus_p3_snd[] = {0x43, 0x43, 0x43, 0x43, 0x43, 0x43, 0x43,
                                     0x43, 0x43, 0x43, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P4_SND_LEN = 19;
static const uint8_t mus_p4_snd[] = {0x58, 0x58, 0x58, 0x58, 0x58, 0x58, 0x58,
                                     0x58, 0x58, 0x58, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P5_SND_LEN = 19;
static const uint8_t mus_p5_snd[] = {0x53, 0x53, 0x53, 0x53, 0x53, 0x53, 0x53,
                                     0x53, 0x53, 0x53, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P6_SND_LEN = 19;
static const uint8_t mus_p6_snd[] = {0x48, 0x48, 0x48, 0x48, 0x48, 0x48, 0x48,
                                     0x48, 0x48, 0x48, 0x00, 0x00, 0x00, 0x00,
                                     0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P7_SND_LEN = 19;
static const uint8_t mus_p7_snd[] = {0x58, 0x58, 0x58, 0x58, 0x58, 0x58, 0x58,
                                     0x58, 0x58, 0x58, 0x58, 0x58, 0x58, 0x58,
                                     0x58, 0x58, 0x58, 0x58, 0x58, 0x58};

static const uint8_t MUS_S21_SND_LEN = 38;
static const uint8_t mus_s21_snd[] = {
    0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89, 0x89,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P21_SND_LEN = 19;
static const uint8_t mus_p21_snd[] = {0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15,
                                      0x15, 0x15, 0x15, 0x00, 0x00, 0x00, 0x00,
                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P22_SND_LEN = 19;
static const uint8_t mus_p22_snd[] = {0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
                                      0x23, 0x23, 0x23, 0x00, 0x00, 0x00, 0x00,
                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P24_SND_LEN = 19;
static const uint8_t mus_p24_snd[] = {0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38,
                                      0x38, 0x38, 0x38, 0x00, 0x00, 0x00, 0x00,
                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P26_SND_LEN = 19;
static const uint8_t mus_p26_snd[] = {0x35, 0x35, 0x35, 0x35, 0x35, 0x35, 0x35,
                                      0x35, 0x35, 0x35, 0x00, 0x00, 0x00, 0x00,
                                      0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_P27_SND_LEN = 38;
static const uint8_t mus_p27_snd[] = {
    0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x38, 0x38, 0x38, 0x38,
    0x38, 0x38, 0x38, 0x38, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
    0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x17, 0x17, 0x17, 0x17,
    0x17, 0x17, 0x17, 0x17, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24};

static const uint8_t MUS_P28_SND_LEN = 38;
static const uint8_t mus_p28_snd[] = {
    0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x45, 0x45, 0x45, 0x45,
    0x45, 0x45, 0x45, 0x45, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31,
    0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x17, 0x17, 0x17, 0x17,
    0x17, 0x17, 0x17, 0x17, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10};

static const uint8_t MUS_P29_SND_LEN = 38;
static const uint8_t mus_p29_snd[] = {
    0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x24, 0x24, 0x24, 0x24,
    0x24, 0x24, 0x24, 0x24, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31,
    0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
    0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45};

static const uint8_t MUS_EP_SND_LEN = 38;
static const uint8_t mus_ep_snd[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t MUS_EP2_SND_LEN = 19;
static const uint8_t mus_ep2_snd[] = {0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
                                      0x45, 0x45, 0x45, 0x45, 0x45, 0x45, 0x45,
                                      0x45, 0x45, 0x45, 0x45, 0x45, 0x45};

static const uint8_t JUMP_SND_LEN = 19;
static const uint8_t jump_snd[] = {0x80, 0x80, 0x80, 0x80, 0x80, 0x55, 0x55,
                                   0x55, 0x55, 0x55, 0x00, 0x00, 0x00, 0x00,
                                   0x00, 0x25, 0x25, 0x25, 0x25, 0x25};

static const uint8_t S_SND_LEN = 38;
static const uint8_t s_snd[] = {0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
                                0x80, 0x80, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
                                0x60, 0x60, 0x60, 0x60, 0x30, 0x30, 0x30, 0x30,
                                0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x10, 0x10,
                                0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10};

static const uint8_t R1_SND_LEN = 9;
static const uint8_t r1_snd[] = {0x95, 0x95, 0x95};

static const uint8_t R2_SND_LEN = 9;
static const uint8_t r2_snd[] = {0x50, 0x50, 0x50};

static const uint8_t SHOT_SND_LEN = 44;
static const uint8_t shot_snd[] = {
    0x10, 0x10, 0x10, 0x6e, 0x2a, 0x20, 0x28, 0x28, 0x9b, 0x28, 0x20,
    0x20, 0x21, 0x57, 0x20, 0x20, 0x20, 0x67, 0x20, 0x20, 0x29, 0x20,
    0x73, 0x20, 0x20, 0x20, 0x89, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

static const uint8_t SHOOT_SND_LEN = 27;
static const uint8_t shoot_snd[] = {0x10, 0x10, 0x10, 0x6e, 0x2a, 0x20, 0x28,
                                    0x28, 0x9b, 0x28, 0x20, 0x20, 0x21, 0x57,
                                    0x20, 0x20, 0x20, 0x67, 0x20, 0x20, 0x29,
                                    0x20, 0x73, 0x20, 0x20, 0x20, 0x89};

static const uint8_t GET_KEY_SND_LEN = 90;
static const uint8_t get_key_snd[] = {
    0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24,
    0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x37, 0x37, 0x37, 0x37, 0x37, 0x37,
    0x37, 0x37, 0x37, 0x37, 0x20, 0x20, 0x20, 0x20, 0x37, 0x37, 0x37, 0x37,
    0x37, 0x37, 0x37, 0x37, 0x37, 0x37, 0x20, 0x20, 0x20, 0x20, 0x37, 0x37,
    0x37, 0x37, 0x37, 0x37, 0x37, 0x37, 0x37, 0x37, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19,
    0x19, 0x19, 0x19, 0x19, 0x19, 0x19};

static const uint8_t HIT_WALL_SND_LEN = 8;
static const uint8_t hit_wall_snd[] = {0x83, 0x83, 0x82, 0x8e,
                                       0x8a, 0x89, 0x86, 0x84};

static const uint8_t WALK1_SND_LEN = 3;
static const uint8_t walk1_snd[] = {0x8f, 0x8e, 0x8e};

static const uint8_t WALK2_SND_LEN = 3;
static const uint8_t walk2_snd[] = {0x84, 0x87, 0x84};

static const uint8_t MEDKIT_SND_LEN = 69;
static const uint8_t medkit_snd[] = {
    0x55, 0x20, 0x3a, 0x3a, 0x3a, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x33, 0x33, 0x33, 0x33, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x26, 0x26, 0x26, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x16,
    0x16, 0x16, 0x16, 0x16, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15};

static const uint8_t MELEE_SND_LEN = 9;
static const uint8_t melee_snd[] = {0x8f, 0x8e, 0x8e};

uint8_t idx = 0;
bool sound = false;
uint16_t snd_ptr = 0;
uint8_t snd_len = 0;
uint8_t music = 0;

/* Function prototypes ------------------------------------------------------ */

/**
 * @brief SOUND initialize audio player state.
 *
 */
void sound_init(void);

/**
 * @brief SOUND update sound and execute platform audio player.
 *
 * @param snd Sound byte array
 * @param len Byte length of sound
 */
void sound_play(const uint8_t *snd, uint8_t len);

/**
 * @brief SOUND get a new frequency from current sound every (1/140)s period,
 * otherwise return the same one again. Return zero if sound is finished.
 *
 * NOTE: Sounds use inverse frequency format, for more information see:
 * 1. http://fabiensanglard.net/gebbwolf3d_v2.1.pdf chapter 4.9.5
 * 2. http://www.shikadi.net/moddingwiki/Inverse_Frequency_Sound_format
 * 3. http://www.shikadi.net/moddingwiki/AudioT_Format
 *
 * @return uint16_t Next sound frequency
 */
uint16_t sound_get_frequency(void);

#endif /* SOUND_H */

/* -------------------------------------------------------------------------- */